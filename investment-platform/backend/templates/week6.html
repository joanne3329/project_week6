   {% extends "base.html" %}

{% block content %}
<!-- è¼‰å…¥ Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="container mt-5">
  <!-- ç« ç¯€é€²åº¦æŒ‡ç¤º -->
  <div class="chapter-progress text-center mb-4">
    <div class="chapters">
      <a href="/week6" class="chapter active">åŸºç¤æ¦‚å¿µ</a>
      <a href="/week6_why_invest" class="chapter">ETF å°è¦½</a>
      <a href="/week6_strategy" class="chapter">æ–°æ‰‹ä¸Šè·¯</a>
    </div>
  </div>

  <!-- æ¨™é¡Œå€ -->
  <div class="text-center mb-5">
    <h1 class="fw-bold animate__animated animate__fadeInDown">åŸºç¤æ¦‚å¿µï¼šETF åˆ°åº•æ˜¯ä»€éº¼ï¼Ÿ</h1>
    <p class="text-muted fs-5 animate__animated animate__fadeIn"> ETF æ˜¯ä»€éº¼ ? ETF çš„èª•ç”Ÿèˆ‡æ¦‚å¿µ</p>
  </div>

  <!-- ETF æºèµ·èªªæ˜å€å¡Š -->
  <div class="intro-text article-section mb-5">
    <div class="intro-quote mb-5">
      <div class="quote-content">
        <p>åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘å€‘å¸¸å¸¸æœƒè½åˆ°ã€ŒæŠ•è³‡ã€é€™å€‹è©ï¼Œå¯èƒ½ä¾†è‡ªå®¶äººä¹‹é–“çš„èŠå¤©ï¼Œæˆ–è€…åœ¨æ–°èè£¡çœ‹åˆ°è‚¡å¸‚çš„æ¼²è·Œï¼Œç”šè‡³æ˜¯åœ¨ YouTube æˆ–ç¤¾ç¾¤å¹³å°ä¸Šçœ‹åˆ°ç¶²ç´…åˆ†äº«æŠ•è³‡å¿ƒå¾—ã€‚å°é«˜ä¸­ç”Ÿè€Œè¨€ï¼ŒæŠ•è³‡çš„ä¸–ç•Œä¼¼ä¹æ—¢ç†Ÿæ‚‰åˆé™é ï¼Œå› ç‚ºä¸€æ–¹é¢æˆ‘å€‘æ—©å·²çŸ¥é“å¤§äººå€‘å¸¸å¸¸è«‡è«–ã€Œè‚¡å¸‚ã€ã€ã€ŒåŸºé‡‘ã€ï¼Œä½†å¦ä¸€æ–¹é¢ï¼Œé€™äº›åè©èƒŒå¾Œçš„æ©Ÿåˆ¶å»é¡¯å¾—ç¥ç¥•è€Œè¤‡é›œã€‚è¦æ‰“é–‹æŠ•è³‡çš„ç¬¬ä¸€æ‰‡é–€ï¼Œæˆ‘å€‘å¿…é ˆå…ˆå¾ä¸€å€‹è¿‘å¹´æœ€å—å¤§çœ¾æ­¡è¿çš„å·¥å…·è«‡èµ·ï¼Œé‚£å°±æ˜¯ ETFã€‚</p>
        <div class="quote-decoration"></div>
      </div>
    </div>
    <div class="article-text">

      <p class="mt-4"><strong>ETFï¼Œå…¨åæ˜¯ã€ŒExchange Traded Fundã€ï¼Œä¸­æ–‡ç¿»è­¯ç‚ºã€ŒæŒ‡æ•¸è‚¡ç¥¨å‹åŸºé‡‘ã€ï¼Œæ˜¯ä¸€ç¨®çµåˆäº†ã€ŒåŸºé‡‘ã€èˆ‡ã€Œè‚¡ç¥¨ã€ç‰¹æ€§çš„æŠ•è³‡å·¥å…·ã€‚</strong>å®ƒæ—¢åƒåŸºé‡‘ä¸€æ¨£ï¼Œèƒ½å¹«æŠ•è³‡äººåˆ†æ•£é¢¨éšªï¼Œå› ç‚ºä¸€æª” ETF è£¡å¾€å¾€åŒ…å«è¨±å¤šä¸åŒçš„è‚¡ç¥¨æˆ–å‚µåˆ¸ï¼›å®ƒåˆåƒè‚¡ç¥¨ä¸€æ¨£ï¼Œå¯ä»¥åœ¨è­‰åˆ¸äº¤æ˜“æ‰€è‡ªç”±è²·è³£ï¼Œåƒ¹æ ¼éš¨æ™‚è®Šå‹•ã€‚é€™ç¨®ã€Œæ—¢æ˜¯åŸºé‡‘åˆåƒè‚¡ç¥¨ã€çš„ç‰¹æ€§ï¼Œä½¿å¾— ETF æˆç‚ºæ–°æ‰‹æŠ•è³‡äººè¸å…¥å¸‚å ´çš„è‰¯å¥½é¸æ“‡ã€‚</p>

      <p class="mt-4"><strong>é€™ç¨®ã€Œæ—¢æ˜¯åŸºé‡‘åˆåƒè‚¡ç¥¨ã€çš„æ··è¡€ç‰¹æ€§ï¼Œä½ çœŸçš„ç†è§£äº†å—ï¼Ÿè®“æˆ‘å€‘é¦¬ä¸Šé€²å…¥åŸºå› å¯¦é©—å®¤ï¼Œè¦ªæ‰‹ã€Œåˆæˆã€ä¸€æª” ETF å§ï¼</strong></p>

      <!-- äº’å‹•å°éŠæˆ²ï¼šETF æ··è¡€å…’åŸºå› é…å°å¯¦é©—å®¤ -->
      <div class="gene-lab-section mt-5 mb-5">
        <h3 class="game-title text-center mb-4">ğŸ”¬ äº’å‹•å°éŠæˆ²ï¼šã€ETF æ··è¡€å…’ï¼šåŸºå› é…å°å¯¦é©—å®¤ã€‘ ğŸ”¬</h3>
        
        <div class="experiment-goal mb-4">
          <h4>ğŸ§¬ å¯¦é©—ç›®æ¨™ï¼šåˆæˆ ETF</h4>
          <p>è«‹å°‡ä¸‹æ–¹çš„ã€Œç‰¹æ€§æ¨™ç±¤ã€æ‹–æ›³åˆ°æ­£ç¢ºçš„ã€ŒåŸºå› ã€é¡åˆ¥ä¸­ï¼Œä¾†è§£é– ETF çš„èª•ç”Ÿï¼</p>
        </div>
        
        <!-- ä¸ŠåŠéƒ¨ï¼šDNA æ”¾ç½®å€ -->
        <div class="dna-zones-container">
          <div class="dna-zone stock-dna" id="stockDnaZone" ondrop="dropTag(event)" ondragover="allowDrop(event)">
            <h4>ğŸ”µ è‚¡ç¥¨ DNA</h4>
            <p class="zone-hint">(è«‹æ‹–æ›³ã€Œè‚¡ç¥¨ç‰¹æ€§ã€åˆ°æ­¤è™•)</p>
            <div class="dropped-tags" id="stockDroppedTags">
              <!-- æ‹–æ›³çš„æ¨™ç±¤å°‡å‡ºç¾åœ¨é€™è£¡ -->
            </div>
          </div>
          
          <div class="dna-zone fund-dna" id="fundDnaZone" ondrop="dropTag(event)" ondragover="allowDrop(event)">
            <h4>ğŸŸ¢ åŸºé‡‘ DNA</h4>
            <p class="zone-hint">(è«‹æ‹–æ›³ã€ŒåŸºé‡‘ç‰¹æ€§ã€åˆ°æ­¤è™•)</p>
            <div class="dropped-tags" id="fundDroppedTags">
              <!-- æ‹–æ›³çš„æ¨™ç±¤å°‡å‡ºç¾åœ¨é€™è£¡ -->
            </div>
          </div>
        </div>

        <hr class="my-4">

        <!-- ä¸‹åŠéƒ¨ï¼šæ¨™ç±¤æ±  -->
        <div class="tag-pool-section">
          <h4>ğŸ·ï¸ ç‰¹æ€§æ¨™ç±¤æ±  (è«‹æ‹–æ›³æˆ‘)</h4>
          <div class="tag-pool" id="tagPool">
            <div class="trait-tag" draggable="true" ondragstart="dragStart(event)" id="tag1" data-trait="trading" data-correct="stock">
              ğŸ·ï¸ å¯åœ¨äº¤æ˜“æ‰€éš¨æ™‚è²·è³£
            </div>
            <div class="trait-tag" draggable="true" ondragstart="dragStart(event)" id="tag2" data-trait="basket" data-correct="fund">
              ğŸ·ï¸ ç”±ä¸€ç±ƒå­è³‡ç”¢çµ„æˆ
            </div>
            <div class="trait-tag" draggable="true" ondragstart="dragStart(event)" id="tag3" data-trait="price" data-correct="stock">
              ğŸ·ï¸ åƒ¹æ ¼éš¨æ™‚è®Šå‹•
            </div>
            <div class="trait-tag" draggable="true" ondragstart="dragStart(event)" id="tag4" data-trait="diversify" data-correct="fund">
              ğŸ·ï¸ å…·å‚™åˆ†æ•£é¢¨éšªçš„æ•ˆæœ
            </div>
          </div>
        </div>

        <!-- åˆæˆæŒ‰éˆ•å€ -->
        <div class="synthesis-section text-center mt-4" style="display: none;" id="synthesisSection">
          <button class="synthesis-btn" onclick="synthesizeETF()" id="synthesisBtn">
            ğŸ§¬ åˆæˆ ETFï¼
          </button>
        </div>

        <!-- åˆæˆçµæœå€ -->
        <div class="synthesis-result" id="synthesisResult" style="display: none;">
          <hr class="my-4">
          <h4 class="text-center">ğŸ‰ åˆæˆæˆåŠŸï¼</h4>
          <div class="result-content text-center">
            <p>ä½ æˆåŠŸçµåˆäº†ã€Œè‚¡ç¥¨ã€å’Œã€ŒåŸºé‡‘ã€çš„é—œéµåŸºå› ï¼Œå‰µé€ å‡ºäº†...</p>
            <div class="spy-result my-4">
              <div class="spy-logo">
                <span class="spy-text">SPY</span>
                <span class="spy-subtitle">SPDR S&P 500 ETF</span>
              </div>
              <div class="spy-family-meme">
                <span class="anya-face">ğŸ¤«</span>
                <span class="waku-text">Waku Waku!</span>
              </div>
            </div>
            <p>...å…¨ä¸–ç•Œç¬¬ä¸€æª”æˆåŠŸçš„ ETFï¼š<strong>SPY</strong>ï¼ (æ‰€ä»¥... SPY... FAMILYï¼Ÿ ğŸ¤«)</p>
          </div>
        </div>
      </div>

      <!-- åŸºå› å¯¦é©—ç¸½çµå½ˆçª— -->
      <div class="gene-popup" id="genePopup" style="display: none;">
        <div class="popup-content">
          <h4 class="popup-title">ğŸ’¡ å¯¦é©—çµè«–ï¼šETF çš„æ··è¡€ç‰¹æ€§</h4>
          <div class="popup-text">
            <p><strong>å¯¦é©—æˆåŠŸï¼ä½ è¨˜ä½äº†å—ï¼Ÿ</strong></p>
            <p><strong>ETF ç¹¼æ‰¿äº†ã€è‚¡ç¥¨ã€‘çš„åŸºå› ï¼š</strong> è®“æˆ‘å€‘å¯ä»¥åƒè²·è³£è‚¡ç¥¨ä¸€æ¨£ã€Œæ–¹ä¾¿äº¤æ˜“ã€ã€ã€Œåƒ¹æ ¼å³æ™‚ã€ã€‚</p>
            <p><strong>ETF ç¹¼æ‰¿äº†ã€åŸºé‡‘ã€‘çš„åŸºå› ï¼š</strong> è®“æˆ‘å€‘å¯ä»¥ä¸€æ¬¡è²·åˆ°ä¸€ç±ƒå­è³‡ç”¢ï¼Œã€Œåˆ†æ•£é¢¨éšªã€ã€‚</p>
            <p><strong>ETF = äº¤æ˜“çš„æ–¹ä¾¿æ€§ + é¢¨éšªçš„åˆ†æ•£æ€§ï¼</strong></p>
          </div>
          <button class="popup-close-btn" onclick="closeGenePopup()">äº†è§£ï¼ç¹¼çºŒæ¢ç´¢æ­·å²</button>
        </div>
      </div>

      <p class="mt-4">ETF çš„èª•ç”Ÿä¸¦ä¸æ˜¯å¶ç„¶ï¼Œè€Œæ˜¯é‡‘èå¸‚å ´ç™¼å±•èˆ‡æŠ•è³‡éœ€æ±‚æ¼”è®Šçš„çµæœã€‚åœ¨ä¸Šå€‹ä¸–ç´€ï¼ŒæŠ•è³‡åŸºé‡‘å·²ç¶“ç›¸ç•¶æµè¡Œï¼Œè¨±å¤šäººæœƒé€éåŸºé‡‘ç¶“ç†äººä¾†å¹«è‡ªå·±ç®¡ç†è³‡é‡‘ã€‚ç„¶è€Œï¼Œå‚³çµ±åŸºé‡‘å¾€å¾€éœ€è¦æ”¯ä»˜é«˜é¡çš„ç®¡ç†è²»ï¼Œä¸”è²·è³£ä¸¦ä¸åƒè‚¡ç¥¨ä¸€æ¨£æ–¹ä¾¿ã€‚1990 å¹´ä»£ï¼Œç¾åœ‹çš„é‡‘èå¸‚å ´é–‹å§‹æ¢ç´¢ä¸€ç¨®æ–°çš„æŠ•è³‡å·¥å…·ï¼šå®ƒå¿…é ˆåŒæ™‚å…¼å…·åˆ†æ•£é¢¨éšªçš„ç‰¹æ€§ï¼Œåˆèƒ½åœ¨äº¤æ˜“æ‰€æ–¹ä¾¿è²·è³£ã€‚1993 å¹´ï¼Œå…¨çƒç¬¬ä¸€æª” ETFâ€”â€”SPDR S&P 500 ETFï¼ˆä»£è™Ÿ SPYï¼‰èª•ç”Ÿï¼Œå®ƒè¿½è¹¤ç¾åœ‹ S&P 500 æŒ‡æ•¸ï¼Œè®“æŠ•è³‡äººèƒ½å¤ ç”¨ç›¸å°ä½çš„æˆæœ¬è²·åˆ°æ•´å€‹å¸‚å ´çš„ä»£è¡¨æ€§è‚¡ç¥¨ã€‚é€™é …å‰µæ–°è¿…é€Ÿå—åˆ°æ­¡è¿ï¼Œä¸¦åœ¨çŸ­çŸ­å¹¾åå¹´é–“å‚³éå…¨çƒã€‚</p>

      <p class="mt-4">ETF ä¸åƒ…åƒ…æ˜¯é‡‘èå•†å“ï¼Œå®ƒå…¶å¯¦åæ˜ äº†ç¤¾æœƒä¸­äººå€‘å°æ–¼ã€Œç°¡å–®ã€æ–¹ä¾¿ã€é€æ˜ã€æŠ•è³‡æ–¹å¼çš„éœ€æ±‚ã€‚å°æ–¼æ²’æœ‰æ™‚é–“ç ”ç©¶å–®ä¸€è‚¡ç¥¨çš„æŠ•è³‡äººä¾†èªªï¼ŒETF æä¾›äº†ä¸€ç¨®ç›¸å°å®‰å¿ƒçš„é¸æ“‡ã€‚å°¤å…¶åœ¨ç¾ä»£ç¤¾æœƒè£¡ï¼ŒæŠ•è³‡å·²ç¶“ä¸å†åªæ˜¯å°‘æ•¸å°ˆæ¥­äººå£«çš„äº‹ï¼Œè€Œæ˜¯æˆç‚ºä¸€èˆ¬å¤§çœ¾å¯¦ç¾è²¡å‹™ç›®æ¨™çš„é‡è¦æ‰‹æ®µã€‚ETF çš„æ™®åŠæ­£æ˜¯é€™ç¨®æ½®æµçš„æœ€ä½³å¯«ç…§ã€‚é€™æ¨£çš„è¨­è¨ˆæ—¢çœæ™‚ï¼Œä¹Ÿèƒ½é¿å…ã€åªåƒä¸€é“èœå¤ªå–®èª¿ã€æˆ–ã€é¸éŒ¯èœçµæœä¸åˆèƒƒå£ã€çš„é¢¨éšªã€‚</p>

      <p class="mt-4">èªªäº†é€™éº¼å¤šï¼Œä¸å¦‚æˆ‘å€‘ç›´æ¥ä¾†ç©ç©çœ‹ï¼é¦¬ä¸Šé«”é©—ã€å–®é»ã€å’Œã€åƒè‡ªåŠ©é¤ã€çš„çœŸå¯¦å·®åˆ¥åœ¨å“ªè£¡ ğŸ‘‡</p>

      <!-- äº’å‹•å°éŠæˆ²ï¼šæŠ•è³‡è‡ªåŠ©é¤ -->
      <div class="investment-game-section mt-5 mb-5">
        <h3 class="game-title text-center mb-4">ğŸ® äº’å‹•å°éŠæˆ²ï¼šã€æŠ•è³‡è‡ªåŠ©é¤ï¼šä»Šæ™šæˆ‘ä½œä¸»ï¼ã€‘ ğŸ®</h3>
        
        <div class="game-container">
          <!-- å·¦æ¬„ï¼šå–®é»é¤å»³ -->
          <div class="game-column single-stock">
            <h4 class="column-title">ğŸ˜± é¢¨éšªé›†ä¸­ï¼šå–®é»é¤å»³ (è²·å€‹è‚¡)</h4>
            <p class="column-desc">ä½ åªæœ‰ä¸€æ¬¡æ©Ÿæœƒï¼Œè«‹ã€Œä¸‰é¸ä¸€ã€æ±ºå®šä½ çš„åˆé¤ï¼</p>
            
            <div class="stock-buttons">
              <button class="stock-btn" onclick="selectStock('tech')" id="tech-btn">
                ğŸ½ï¸ A ç§‘æŠ€ç‰›æ’
              </button>
              <button class="stock-btn" onclick="selectStock('traditional')" id="traditional-btn">
                ğŸ— B å‚³ç”¢é›è…¿
              </button>
              <button class="stock-btn" onclick="selectStock('shipping')" id="shipping-btn">
                ğŸ¦ C èˆªé‹é¾è¦
              </button>
            </div>
            
            <div class="result-box" id="single-result" style="display: none;">
              <!-- çµæœå°‡å‹•æ…‹æ’å…¥é€™è£¡ -->
            </div>
          </div>

          <!-- å³æ¬„ï¼šè‡ªåŠ©é¤å»³ -->
          <div class="game-column etf-buffet">
            <h4 class="column-title">ğŸ˜Š é¢¨éšªåˆ†æ•£ï¼šè‡ªåŠ©é¤å»³ (è²· ETF)</h4>
            <p class="column-desc">ä½ ä¸ç”¨é¸ï¼é¤å»³å¹«ä½ é…å¥½äº†ä¸€æ•´ç›¤èœï¼</p>
            
            <div class="etf-button">
              <button class="etf-btn" onclick="selectETF()" id="etf-btn">
                ğŸ± æ‹¿å– ETF çµ„åˆé¤ç›¤ (0050)
              </button>
            </div>
            
            <div class="result-box" id="etf-result" style="display: none;">
              <!-- çµæœå°‡å‹•æ…‹æ’å…¥é€™è£¡ -->
            </div>
          </div>
        </div>
      </div>

      <!-- éŠæˆ²ç¸½çµå½ˆçª— -->
      <div class="game-popup" id="gamePopup" style="display: none;">
        <div class="popup-content">
          <h4 class="popup-title">ğŸ’¡ éŠæˆ²çµè«–ï¼šé€™å°±æ˜¯ã€Œåˆ†æ•£é¢¨éšªã€ï¼</h4>
          <div class="popup-text">
            <p><strong>ä½ ç™¼ç¾äº†å—ï¼Ÿ</strong></p>
            <p><strong>å–®é»ï¼ˆè²·å€‹è‚¡ï¼‰ï¼š</strong> é¢¨éšªéå¸¸é›†ä¸­ï¼ä½ å¯èƒ½é‹æ°£å¥½å¤§è³º (+50%)ï¼Œä½†ä¹Ÿå¯èƒ½é‹æ°£å·®å¤§è³  (-40%)ï¼Œå¿ƒè‡Ÿè¦å¾ˆå¤§é¡†ã€‚</p>
            <p><strong>è‡ªåŠ©é¤ï¼ˆè²· ETFï¼‰ï¼š</strong> å¹«ä½ è‡ªå‹•çµ„åˆäº†å¤šç¨®èœè‰²ã€‚å°±ç®—æœ‰ä¸€å…©é“èœä¸å¥½åƒ (-10%)ï¼Œå…¶ä»–çš„ä¹Ÿæœƒè£œå›ä¾† (+15%)ã€‚</p>
            <p><strong>ETF è®“ä½ çš„æ•´é«”è¡¨ç¾æ›´ç©©å¥ï¼Œä¸å®¹æ˜“è¡€æœ¬ç„¡æ­¸ï¼</strong></p>
          </div>
          <button class="popup-close-btn" onclick="closeGamePopup()">æˆ‘æ‡‚äº†ï¼ç¹¼çºŒå­¸ç¿’</button>
        </div>
      </div>

      <p class="mt-4">ETF ä¸åƒ…åƒ…æ˜¯é‡‘èå•†å“ï¼Œå®ƒå…¶å¯¦åæ˜ äº†ç¤¾æœƒä¸­äººå€‘å°æ–¼ã€Œç°¡å–®ã€æ–¹ä¾¿ã€é€æ˜ã€æŠ•è³‡æ–¹å¼çš„éœ€æ±‚ã€‚å°æ–¼æ²’æœ‰æ™‚é–“ç ”ç©¶å–®ä¸€è‚¡ç¥¨çš„æŠ•è³‡äººä¾†èªªï¼ŒETF æä¾›äº†ä¸€ç¨®ç›¸å°å®‰å¿ƒçš„é¸æ“‡ã€‚å°¤å…¶åœ¨ç¾ä»£ç¤¾æœƒè£¡ï¼ŒæŠ•è³‡å·²ç¶“ä¸å†åªæ˜¯å°‘æ•¸å°ˆæ¥­äººå£«çš„äº‹ï¼Œè€Œæ˜¯æˆç‚ºä¸€èˆ¬å¤§çœ¾å¯¦ç¾è²¡å‹™ç›®æ¨™çš„é‡è¦æ‰‹æ®µã€‚ETF çš„æ™®åŠæ­£æ˜¯é€™ç¨®æ½®æµçš„æœ€ä½³å¯«ç…§ã€‚</p>
      <p class="mt-4">åœ¨å°ç£ï¼ŒETF çš„ç†±æ½®å¤§ç´„å¾ 2017 å¹´å¾Œå¿«é€Ÿå‡æº«ï¼Œå°¤å…¶æ˜¯è‚¡ç¥¨å‹ ETFï¼Œå¦‚ã€Œ0050 å…ƒå¤§å°ç£50ã€å’Œã€Œ0056 å…ƒå¤§é«˜è‚¡æ¯ã€ï¼Œæˆç‚ºè¨±å¤šå°è³‡æ—å’Œæ–°æ‰‹æŠ•è³‡äººçš„é¦–é¸ã€‚åŸå› åœ¨æ–¼é€™äº› ETF ä¸åƒ…æ¨™çš„æ¸…æ¥šï¼ˆå‰è€…è¿½è¹¤å°ç£å‰ 50 å¤§å¸‚å€¼å…¬å¸ï¼Œå¾Œè€…å°ˆæ³¨æ–¼é«˜è‚¡æ¯å…¬å¸ï¼‰ï¼Œè€Œä¸”è²·è³£æ–¹å¼å’Œè‚¡ç¥¨ä¸€æ¨£ç°¡å–®ï¼Œåªè¦æœ‰è­‰åˆ¸å¸³æˆ¶ï¼Œå¹¾ä¹äººäººéƒ½èƒ½åƒèˆ‡ã€‚è¨±å¤šè­‰åˆ¸å…¬å¸ä¹Ÿæœƒé€éå»£å‘Šã€æ•™å­¸æ–‡ç« æˆ–ç·šä¸Šèª²ç¨‹ä¾†æ¨å»£ ETFï¼Œå› ç‚ºå®ƒæ¯”èµ·å€‹è‚¡æŠ•è³‡æ›´å®¹æ˜“ç†è§£ï¼Œä¹Ÿæ›´ç¬¦åˆå¤§çœ¾æŠ•è³‡æ•™è‚²çš„éœ€æ±‚ã€‚</p>
      <p class="mt-4">ç•¶ç„¶ï¼ŒETF çš„ä¸–ç•Œä¸¦ä¸åªæœ‰è‚¡ç¥¨å‹ï¼Œé‚„åŒ…æ‹¬å‚µåˆ¸å‹ã€å•†å“å‹ã€ç”šè‡³æ˜¯ä¸»é¡Œå‹ã€‚ä¾‹å¦‚ï¼Œå‚µåˆ¸å‹ ETF å°±åƒæ˜¯æŠŠè¨±å¤šä¸åŒçš„æ”¿åºœå‚µåˆ¸æˆ–å…¬å¸å‚µæ‰“åŒ…åœ¨ä¸€èµ·ï¼Œè®“æŠ•è³‡äººä¸éœ€è¦é€ä¸€æŒ‘é¸å‚µåˆ¸ï¼Œå°±èƒ½ä¸€æ¬¡è²·åˆ°ä¸€ç±ƒå­çš„å‚µåˆ¸è³‡ç”¢ã€‚è‡³æ–¼å•†å“å‹ ETFï¼Œå‰‡å¯èƒ½è¿½è¹¤é»ƒé‡‘ã€çŸ³æ²¹ç­‰å¤§å®—å•†å“çš„åƒ¹æ ¼ã€‚ä¸»é¡Œå‹ ETF å‰‡æ›´è²¼è¿‘æ—¥å¸¸ç”Ÿæ´»ï¼Œä¾‹å¦‚ã€Œé›»å‹•è»Š ETFã€ã€ã€ŒAI äººå·¥æ™ºæ…§ ETFã€ç­‰ï¼Œè®“æŠ•è³‡äººå¯ä»¥é‡å°è‡ªå·±çœ‹å¥½çš„ç”¢æ¥­é€²è¡ŒæŠ•è³‡ã€‚ä¸éï¼Œåœ¨é€™å€‹èª²ç¨‹è£¡ï¼Œæˆ‘å€‘æœƒå°ˆæ³¨åœ¨è‚¡ç¥¨å‹å’Œå‚µåˆ¸å‹å…©å¤§ä¸»æµï¼Œå› ç‚ºå®ƒå€‘å°æ–¼æ–°æ‰‹è€Œè¨€æœ€åŸºç¤ã€æœ€å®¹æ˜“ç†è§£ï¼Œä¹Ÿæœ€èƒ½å¹«åŠ©æ‰“ä¸‹ç©©å›ºçš„æŠ•è³‡åŸºç¤ã€‚</p>
      <p class="mt-4">æœ‰è¶£çš„æ˜¯ï¼ŒETF çš„æŠ•è³‡ç†å¿µå…¶å¯¦å’Œé«˜ä¸­ç”Ÿçš„ç”Ÿæ´»ä¸¦ä¸é™é ã€‚æƒ³åƒä¸€ä¸‹ï¼Œåœ¨è€ƒè©¦çš„æ™‚å€™ï¼Œå¦‚æœä½ æŠŠå…¨éƒ¨å¿ƒåŠ›éƒ½æ”¾åœ¨ä¸€ç§‘ï¼Œä¾‹å¦‚æ•¸å­¸ï¼Œé›–ç„¶æœ‰å¯èƒ½å¾—åˆ°é«˜åˆ†ï¼Œbutå¦‚æœæ•¸å­¸å‡ºç¾é›£é¡Œï¼Œä½ å°±æœƒé™·å…¥å±æ©Ÿï¼›ç›¸åï¼Œå¦‚æœä½ å¹³å‡åˆ†é…æ™‚é–“çµ¦æ•¸å­¸ã€è‹±æ–‡ã€ç¤¾æœƒç­‰å¤šç§‘ï¼Œé›–ç„¶å–®ç§‘æˆç¸¾å¯èƒ½ä¸æœƒè¡å¾—ç‰¹åˆ¥é«˜ï¼Œä½†æ•´é«”è¡¨ç¾æœƒæ¯”è¼ƒç©©å®šã€‚ETF å°±åƒé€™æ¨£çš„å­¸ç¿’ç­–ç•¥ï¼Œå®ƒå¹«åŠ©æŠ•è³‡äººä¸è¦æŠŠé›è›‹æ”¾åœ¨åŒä¸€å€‹ç±ƒå­è£¡ï¼Œè€Œæ˜¯åˆ†æ•£åœ¨å¤šå€‹ç§‘ç›®ï¼ˆæˆ–è‚¡ç¥¨ã€å‚µåˆ¸ï¼‰ä¸Šï¼Œè®“ä½ çš„æŠ•è³‡æˆç¸¾ä¸æœƒå› ç‚ºå–®ä¸€ç§‘ç›®å¤±åˆ©è€Œå…¨ç›¤çš†è¼¸ã€‚</p>

      <p class="mt-4">æ˜¯ä¸æ˜¯è½èµ·ä¾†å¾ˆæœ‰é“ç†ï¼Ÿåˆ¥åªæ˜¯æƒ³åƒï¼Œæˆ‘å€‘ç›´æ¥ä¾†æ¨¡æ“¬ä¸€æ¬¡æœŸæœ«è€ƒï¼Œçœ‹çœ‹ä½ æœƒé¸å“ªç¨®ç­–ç•¥ï¼</p>

      <!-- äº’å‹•å°éŠæˆ²ï¼šå­¸éœ¸çš„æŠ•è³‡ç­–ç•¥ -->
      <div class="study-strategy-game-section mt-5 mb-5">
        <h3 class="game-title text-center mb-4">ğŸ‘©â€ğŸ“ äº’å‹•å°éŠæˆ²ï¼šã€å­¸éœ¸çš„æŠ•è³‡ç­–ç•¥ï¼šæœŸæœ« All Pass è¡“ã€‘ ğŸ‘¨â€ğŸ“</h3>
        
        <div class="scenario-setting mb-4">
          <h4>ğŸš¨ æƒ…å¢ƒï¼šæœŸæœ«è€ƒå‰å¤•</h4>
          <p>ä½ ç¾åœ¨æœ‰ <strong>100 é»ã€Œè®€æ›¸ç²¾åŠ›å€¼ã€</strong>ï¼Œè€ƒè©¦ç§‘ç›®æœ‰äº”ç§‘ï¼šã€æ•¸å­¸ã€‘ã€ã€è‹±æ–‡ã€‘ã€ã€ç‰©ç†ã€‘ã€ã€ç¤¾æœƒã€‘ã€ã€åœ‹æ–‡ã€‘ã€‚</p>
          <p><strong>è«‹é¸æ“‡ä½ çš„è®€æ›¸ç­–ç•¥ï¼ˆäºŒé¸ä¸€ï¼‰ï¼</strong></p>
        </div>
        
        <div class="study-game-container">
          <!-- å·¦æ¬„ï¼šç­–ç•¥ A -->
          <div class="strategy-column strategy-a">
            <h4 class="strategy-title">ç­–ç•¥ Aï¼šé‡å£“å–®ç§‘ (All-in å€‹è‚¡)</h4>
            <p class="strategy-desc">ã€Œæˆ‘è¦æ‹¼äº†ï¼æŠŠ 100 é»ç²¾åŠ›å€¼å…¨éƒ¨æŠ•å…¥ã€æ•¸å­¸ã€‘ï¼è³­ä¸€æŠŠï¼ã€</p>
            
            <div class="strategy-button">
              <button class="strategy-btn all-in-btn" onclick="selectStudyStrategy('all-in')" id="all-in-btn">
                ğŸš€ é¸æ“‡ç­–ç•¥ Aï¼šæ•¸å­¸æ˜¯æˆ‘çš„å…¨éƒ¨ï¼
              </button>
            </div>
          </div>

          <!-- å³æ¬„ï¼šç­–ç•¥ B -->
          <div class="strategy-column strategy-b">
            <h4 class="strategy-title">ç­–ç•¥ Bï¼šå¹³å‡åˆ†é… (ä½ˆå±€ ETF)</h4>
            <p class="strategy-desc">ã€Œç©©å¥ All Pass æ‰é‡è¦ï¼äº”ç§‘å„æŠ•å…¥ 20 é»ç²¾åŠ›å€¼ã€‚ã€</p>
            
            <div class="strategy-button">
              <button class="strategy-btn balanced-btn" onclick="selectStudyStrategy('balanced')" id="balanced-btn">
                ğŸ›¡ï¸ é¸æ“‡ç­–ç•¥ Bï¼šæˆ‘è¦ç©©ç©©çš„å¹¸ç¦ï¼
              </button>
            </div>
          </div>
        </div>

        <!-- çµæœåé¥‹å€ -->
        <div class="study-result-section" id="studyResult" style="display: none;">
          <hr class="my-4">
          <h4 class="result-title text-center">ğŸ“œ æœŸæœ«è€ƒæ”¾æ¦œï¼</h4>
          <div class="result-content" id="studyResultContent">
            <!-- çµæœå°‡å‹•æ…‹æ’å…¥é€™è£¡ -->
          </div>
        </div>
      </div>

      <!-- å­¸ç¿’ç­–ç•¥ç¸½çµå½ˆçª— -->
      <div class="study-popup" id="studyPopup" style="display: none;">
        <div class="popup-content">
          <h4 class="popup-title">ğŸ’¡ éŠæˆ²çµè«–ï¼šæŠ•è³‡å°±æ˜¯è®€æ›¸ç­–ç•¥ï¼</h4>
          <div class="popup-text">
            <p><strong>é€™å°±æ˜¯ ETF çš„ç²¾ç¥ï¼</strong></p>
            <p><strong>ç­–ç•¥ A (é‡å£“å€‹è‚¡)ï¼š</strong> å°±åƒ All-in å–®ç§‘ï¼Œä½ å¯èƒ½æˆç‚ºæ¦œé¦– (å¤§è³º)ï¼Œä½†ä¹Ÿå¯èƒ½å› ç‚ºä¸€æ¬¡å¤±åˆ© (å¤§è³ ) å°±å…¨ç›¤çš†è¼¸ã€‚</p>
            <p><strong>ç­–ç•¥ B (ä½ˆå±€ ETF)ï¼š</strong> å°±åƒå¹³å‡åˆ†é…æ™‚é–“ï¼Œå°±ç®—æ•¸å­¸è€ƒå·®äº† (60åˆ†)ï¼Œä½ çš„è‹±æ–‡ (85åˆ†) å’Œåœ‹æ–‡ (90åˆ†) æœƒæŠŠæ•´é«”æˆç¸¾æ•‘å›ä¾†ã€‚</p>
            <p><strong>ETF çŠ§ç‰²äº†æœ€é«˜çš„çˆ†ç™¼åŠ›ï¼Œæ›å–äº†ã€Œä¸å®¹æ˜“ç¿»è»Šã€çš„ç©©å¥è¡¨ç¾ï¼</strong></p>
          </div>
          <button class="popup-close-btn" onclick="closeStudyPopup()">æˆ‘å­¸æœƒäº†ï¼ç¹¼çºŒå‰é€²</button>
        </div>
      </div>

      <p class="mt-4">åœ¨äº†è§£äº† ETF çš„èª•ç”ŸèƒŒæ™¯èˆ‡åŸºæœ¬æ¦‚å¿µä¹‹å¾Œï¼Œæˆ‘å€‘å¯ä»¥é–‹å§‹é€²ä¸€æ­¥æ¢è¨è‚¡ç¥¨å‹ ETF èˆ‡å‚µåˆ¸å‹ ETF çš„ç‰¹æ€§ï¼Œçœ‹çœ‹å®ƒå€‘å¦‚ä½•åœ¨ä¸åŒçš„å¸‚å ´æƒ…å¢ƒä¸‹ç™¼æ®ä½œç”¨ã€‚é€™å°±åƒæ˜¯è‡ªåŠ©é¤è£¡çš„å…©å¤§ä¸»èœï¼Œä¸€å€‹åå‘æ–¼é«˜è®Šå‹•ã€é«˜æ½›åŠ›çš„é¢¨å‘³æ–™ç†ï¼ˆè‚¡ç¥¨å‹ ETFï¼‰ï¼Œå¦ä¸€å€‹å‰‡æ˜¯ç©©å¥ã€èƒ½è®“äººå®‰å¿ƒçš„å‚³çµ±å®¶å¸¸èœï¼ˆå‚µåˆ¸å‹ ETFï¼‰ã€‚ç†è§£é€™å…©è€…çš„å·®ç•°ï¼Œæ˜¯æˆ‘å€‘èµ°é€² ETF ä¸–ç•Œçš„é—œéµä¸€æ­¥ã€‚</p>
    </div>
  </div>

  <!-- ä¸‹ä¸€é æŒ‰éˆ• -->
  <div class="next-page-section text-center py-5 my-5">
    <div class="next-page-banner p-4 rounded-lg">
      <h3 class="mb-3">æº–å‚™å¥½å­¸ç¿’ä¸‹ä¸€å€‹ä¸»é¡Œäº†å—ï¼Ÿ</h3>
      <p class="lead mb-4">æ¥ä¸‹ä¾†æˆ‘å€‘å°‡æ¢è¨è‚¡ç¥¨å‹èˆ‡å‚µåˆ¸å‹ ETF çš„å·®ç•°</p>
      <a href="/week6_why_invest" class="btn btn-primary btn-lg">
        å‰å¾€ä¸‹ä¸€ç« ç¯€
        <i class="fas fa-arrow-right ms-2"></i>
      </a>
    </div>
  </div>

  <!-- è¿”å›æŒ‰éˆ• -->
  <div class="text-center mt-5">
    <a href="/map" class="btn btn-secondary me-3">è¿”å›å­¸ç¿’åœ°åœ–</a>
  </div>

  <!-- ETF å°åŠ©æ‰‹ -->
  <div class="ai-assistant">
    <button class="ai-toggle-btn" onclick="toggleAIChat()">
      <span class="ai-icon">ğŸ¤–</span>
      <span class="ai-label">ETF å°åŠ©æ‰‹</span>
    </button>
    
    <div class="ai-chat-container" id="aiChat">
      <div class="ai-chat-header">
        <h5 class="mb-0">ETF å°åŠ©æ‰‹</h5>
        <button class="close-btn" onclick="toggleAIChat()">Ã—</button>
      </div>
      <div class="ai-chat-messages" id="aiMessages">
        <div class="ai-message">
          <span class="ai-icon">ğŸ¤–</span>
          <div class="message-content">
            ä½ å¥½ï¼æˆ‘æ˜¯ ETF æŠ•è³‡å°åŠ©æ‰‹ã€‚è«‹é¸æ“‡æ‚¨æƒ³äº†è§£çš„å•é¡Œï¼š
          </div>
        </div>
        <div class="question-buttons">
          <button class="preset-question" onclick="askPresetQuestion('ä»€éº¼æ˜¯ ETFï¼Ÿç‚ºä»€éº¼è¦æŠ•è³‡ ETFï¼Ÿ')">
            ä»€éº¼æ˜¯ ETFï¼Ÿç‚ºä»€éº¼è¦æŠ•è³‡ ETFï¼Ÿ
          </button>
          <button class="preset-question" onclick="askPresetQuestion('ETF å’Œè‚¡ç¥¨åŸºé‡‘æœ‰ä»€éº¼ä¸åŒï¼Ÿ')">
            ETF å’Œè‚¡ç¥¨åŸºé‡‘æœ‰ä»€éº¼ä¸åŒï¼Ÿ
          </button>
          <button class="preset-question" onclick="askPresetQuestion('å¦‚ä½•é¸æ“‡é©åˆè‡ªå·±çš„ ETFï¼Ÿ')">
            å¦‚ä½•é¸æ“‡é©åˆè‡ªå·±çš„ ETFï¼Ÿ
          </button>
          <button class="preset-question" onclick="askPresetQuestion('ETF æŠ•è³‡æœ‰å“ªäº›é¢¨éšªï¼Ÿ')">
            ETF æŠ•è³‡æœ‰å“ªäº›é¢¨éšªï¼Ÿ
          </button>
          <button class="preset-question" onclick="askPresetQuestion('0050 å’Œ 0056 æœ‰ä»€éº¼å·®åˆ¥ï¼Ÿ')">
            0050 å’Œ 0056 æœ‰ä»€éº¼å·®åˆ¥ï¼Ÿ
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
/* ETF å°åŠ©æ‰‹æ¨£å¼ */
.ai-assistant {
  position: fixed;
  left: 20px;
  bottom: 20px;
  z-index: 1000;
}

.ai-toggle-btn {
  background: #1a73e8;
  color: white;
  border: none;
  border-radius: 30px;
  padding: 12px 24px;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(26,115,232,0.2);
  transition: all 0.3s ease;
}

.ai-toggle-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(26,115,232,0.3);
}

.ai-chat-container {
  position: fixed;
  left: 20px;
  bottom: 80px;
  width: 320px;
  height: 450px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
  display: none;
  flex-direction: column;
}

.ai-chat-header {
  padding: 16px;
  border-bottom: 1px solid #eee;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.close-btn {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #666;
}

.ai-chat-messages {
  flex: 1;
  padding: 16px;
  overflow-y: auto;
}

.ai-message {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
}

.message-content {
  background: #f0f7ff;
  padding: 12px 16px;
  border-radius: 12px;
  max-width: 85%;
  white-space: pre-line;
  text-align: left;
  line-height: 1.5;
}

.message-content ul {
  margin: 8px 0;
  padding-left: 20px;
}

.message-content li {
  margin-bottom: 6px;
}

.message-content strong {
  color: #1a73e8;
}

.ai-message .message-content {
  margin-right: auto;
}

.question-buttons {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
}

.preset-question {
  background: #f8f9fa;
  color: #1a73e8;
  border: 1px solid #e3e3e3;
  border-radius: 8px;
  padding: 12px;
  text-align: left;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 0.95rem;
}

.preset-question:hover {
  background: #f0f7ff;
  border-color: #1a73e8;
  transform: translateX(5px);
}

/* å‹•ç•«æ•ˆæœ */
@keyframes typing {
  from { 
    max-height: 0;
    opacity: 0;
  }
  to { 
    max-height: 500px;
    opacity: 1;
  }
}

.typing-animation {
  display: block;
  overflow: hidden;
  white-space: pre-wrap;
  animation: typing 0.5s ease-in-out;
  animation-fill-mode: forwards;
}

/* é€²åº¦æŒ‡ç¤ºå™¨æ¨£å¼ */
.chapter-progress {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 30px;
}

.chapters {
  display: flex;
  justify-content: center;
  gap: 20px;
}

.chapter {
  font-size: 1.2rem;
  color: #666;
  text-decoration: none;
  padding: 10px 20px;
  border-radius: 6px;
  transition: all 0.3s ease;
}

.chapter:hover {
  background: #e3f2fd;
  color: #1a73e8;
}

.chapter.active {
  background: #1a73e8;
  color: white;
  font-weight: 500;
}

/* ETF ç‰¹æ€§å¡ç‰‡æ¨£å¼ */
.feature-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
  max-width: 1000px;
  margin: 0 auto;
}

.feature-card {
  background: white;
  padding: 24px;
  border-radius: 12px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  text-align: center;
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.feature-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

.feature-icon {
  font-size: 2.5rem;
  margin-bottom: 16px;
}

.feature-card h4 {
  color: #1a73e8;
  margin-bottom: 12px;
  font-size: 1.2rem;
}

.feature-detail {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(26,115,232,0.95);
  color: white;
  padding: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  opacity: 0;
  transform: scale(0.9);
  transition: all 0.3s ease;
  line-height: 1.6;
}

.feature-card:hover .feature-detail {
  opacity: 1;
  transform: scale(1);
}

/* å¼•è¨€å€å¡Šæ¨£å¼ */
.intro-quote {
  position: relative;
  background: #f8f9fa;
  border-radius: 16px;
  padding: 30px;
  margin: 40px auto;
  max-width: 800px;
  box-shadow: 0 2px 15px rgba(0,0,0,0.08);
}

.quote-content {
  position: relative;
  font-size: 1.15rem;
  line-height: 1.8;
  color: #445;
  font-style: italic;
  text-align: justify;
}

.quote-content p {
  margin: 0;
  padding: 0;
}

.quote-decoration {
  position: absolute;
  left: -20px;
  top: -20px;
  width: 40px;
  height: 40px;
  background: #1a73e8;
  border-radius: 50%;
  opacity: 0.1;
}

.quote-decoration::before {
  content: '"';
  position: absolute;
  left: 12px;
  top: 8px;
  font-size: 40px;
  color: #1a73e8;
  font-family: Georgia, serif;
}

/* åœ–ç‰‡å®¹å™¨æ¨£å¼ */
.chart-container {
  max-width: 800px;
  margin: 0 auto;
  padding: 0 15px;
}

.chart-container img {
  width: 100%;
  height: auto;
}

/* ä¸‹ä¸€é æŒ‰éˆ•æ¨£å¼ */
.next-page-banner {
  background: #f8f9fa;
  max-width: 600px;
  margin: 0 auto;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.next-page-banner h3 {
  color: #1a73e8;
}

.next-page-banner .btn-primary {
  background-color: #1a73e8;
  border-color: #1a73e8;
  padding: 12px 30px;
  font-weight: 500;
  transition: all 0.3s ease;
}

.next-page-banner .btn-primary:hover {
  transform: translateX(5px);
  box-shadow: 0 4px 12px rgba(26,115,232,0.2);
}

/* è§£å‰– ETF æ¨£å¼ */
.etf-anatomy-section {
  background: #f8f9fa;
  padding: 40px 20px;
  border-radius: 16px;
  margin: 40px auto;
  max-width: 1000px;
}

.anatomy-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 30px;
}

.etf-buttons {
  display: flex;
  justify-content: center;
  gap: 30px;
  flex-wrap: wrap;
}

.etf-box {
  background: white;
  padding: 30px 20px;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 200px;
  border: 3px solid transparent;
}

.etf-box:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  border-color: #1a73e8;
}

.etf-box.active {
  border-color: #1a73e8;
  background: #f0f7ff;
}

.box-icon {
  font-size: 3rem;
  margin-bottom: 15px;
}

.etf-box h4 {
  color: #1a73e8;
  margin-bottom: 10px;
  font-size: 1.2rem;
}

.etf-box p {
  color: #666;
  margin: 0;
  font-size: 0.9rem;
}

.chart-containers {
  width: 100%;
  max-width: 800px;
}

.chart-container {
  background: white;
  padding: 30px;
  border-radius: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  opacity: 0;
  transform: translateY(20px);
  transition: all 0.4s ease;
}

.chart-container.show {
  opacity: 1;
  transform: translateY(0);
  display: block;
}

.chart-title {
  color: #1a73e8;
  text-align: center;
  margin-bottom: 20px;
  font-size: 1.3rem;
}

.chart-wrapper {
  max-width: 400px;
  margin: 0 auto;
  position: relative;
}

.chart-description {
  text-align: center;
  margin-top: 20px;
}

.chart-description p {
  color: #666;
  font-size: 0.95rem;
  margin: 0;
}

/* äº’å‹•éŠæˆ²æ¨£å¼ */
.investment-game-section {
  background: #f8f9fa;
  padding: 30px 20px;
  border-radius: 16px;
  border: 2px solid #e3f2fd;
  margin: 40px auto;
  max-width: 1000px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.game-title {
  color: #1a73e8;
  font-size: 1.5rem;
  font-weight: bold;
  margin-bottom: 30px;
}

.game-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  max-width: 900px;
  margin: 0 auto;
}

.game-column {
  background: white;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.08);
}

.column-title {
  color: #333;
  font-size: 1.2rem;
  margin-bottom: 15px;
  text-align: center;
}

.column-desc {
  color: #666;
  text-align: center;
  margin-bottom: 20px;
}

.stock-buttons {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 20px;
}

.stock-btn {
  background: #fff;
  border: 2px solid #1a73e8;
  border-radius: 8px;
  padding: 12px 16px;
  color: #1a73e8;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.stock-btn:hover {
  background: #1a73e8;
  color: white;
  transform: translateY(-2px);
}

.stock-btn:disabled {
  background: #f5f5f5;
  border-color: #ddd;
  color: #999;
  cursor: not-allowed;
  transform: none;
}

.etf-button {
  text-align: center;
  margin-bottom: 20px;
}

.etf-btn {
  background: #28a745;
  border: none;
  border-radius: 8px;
  padding: 15px 25px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1.1rem;
}

.etf-btn:hover {
  background: #218838;
  transform: translateY(-2px);
}

.etf-btn:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.result-box {
  background: #f8f9fa;
  border-radius: 8px;
  padding: 20px;
  border-left: 4px solid #1a73e8;
  margin-top: 15px;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.4s ease;
}

.result-box.show {
  opacity: 1;
  transform: translateY(0);
}

.result-positive {
  border-left-color: #28a745;
  background: #d4edda;
}

.result-negative {
  border-left-color: #dc3545;
  background: #f8d7da;
}

.result-neutral {
  border-left-color: #ffc107;
  background: #fff3cd;
}

.etf-calculation {
  font-size: 0.9rem;
  line-height: 1.6;
  margin-bottom: 15px;
}

.etf-calculation div {
  margin-bottom: 5px;
}

.etf-total {
  border-top: 2px solid #28a745;
  padding-top: 10px;
  font-weight: bold;
  color: #28a745;
}

/* å½ˆçª—æ¨£å¼ */
.game-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
}

.popup-content {
  background: white;
  padding: 30px;
  border-radius: 16px;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  text-align: center;
}

.popup-title {
  color: #1a73e8;
  margin-bottom: 20px;
  font-size: 1.3rem;
}

.popup-text {
  text-align: left;
  margin-bottom: 25px;
  line-height: 1.6;
}

.popup-text p {
  margin-bottom: 15px;
}

.popup-close-btn {
  background: #1a73e8;
  color: white;
  border: none;
  border-radius: 8px;
  padding: 12px 24px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.popup-close-btn:hover {
  background: #0d47a1;
  transform: translateY(-2px);
}

/* å­¸ç¿’ç­–ç•¥éŠæˆ²æ¨£å¼ */
.study-strategy-game-section {
  background: #f8f9fa;
  padding: 30px 20px;
  border-radius: 16px;
  border: 2px solid #e3f2fd;
  margin: 40px auto;
  max-width: 1000px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.scenario-setting {
  background: white;
  padding: 25px;
  border-radius: 12px;
  border-left: 4px solid #1a73e8;
  margin-bottom: 30px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.scenario-setting h4 {
  color: #1a73e8;
  margin-bottom: 15px;
}

.scenario-setting p {
  margin-bottom: 10px;
  line-height: 1.6;
  font-style: italic;
}

.study-game-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  max-width: 900px;
  margin: 0 auto;
}

.strategy-column {
  background: white;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.08);
  text-align: center;
}

.strategy-title {
  color: #333;
  font-size: 1.2rem;
  margin-bottom: 15px;
}

.strategy-desc {
  color: #666;
  margin-bottom: 25px;
  line-height: 1.5;
  font-style: italic;
}

.strategy-button {
  margin-bottom: 20px;
}

.strategy-btn {
  border: none;
  border-radius: 8px;
  padding: 15px 20px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1rem;
  width: 100%;
}

.all-in-btn {
  background: #ff6b35;
  color: white;
}

.all-in-btn:hover {
  background: #e55a30;
  transform: translateY(-2px);
}

.balanced-btn {
  background: #28a745;
  color: white;
}

.balanced-btn:hover {
  background: #218838;
  transform: translateY(-2px);
}

.strategy-btn:disabled {
  background: #6c757d;
  cursor: not-allowed;
  transform: none;
}

.study-result-section {
  margin-top: 30px;
}

.result-title {
  color: #1a73e8;
  margin-bottom: 20px;
  font-size: 1.3rem;
}

.result-content {
  background: white;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.08);
}

.score-card {
  background: #f8f9fa;
  padding: 20px;
  border-radius: 8px;
  margin: 15px 0;
}

.score-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
  padding: 5px 0;
}

.score-subject {
  font-weight: 500;
}

.score-value {
  font-weight: bold;
}

.score-high {
  color: #28a745;
}

.score-low {
  color: #dc3545;
}

.score-medium {
  color: #ffc107;
}

.final-result {
  background: #e3f2fd;
  padding: 15px;
  border-radius: 8px;
  margin-top: 15px;
  border-left: 4px solid #1a73e8;
}

.final-result.success {
  background: #d4edda;
  border-left-color: #28a745;
}

.final-result.failure {
  background: #f8d7da;
  border-left-color: #dc3545;
}

.study-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
}

/* åŸºå› å¯¦é©—å®¤æ¨£å¼ */
.gene-lab-section {
  background: #f8f9fa;
  padding: 30px 20px;
  border-radius: 16px;
  border: 2px solid #e3f2fd;
  margin: 40px auto;
  max-width: 1000px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.experiment-goal {
  background: white;
  padding: 25px;
  border-radius: 12px;
  border-left: 4px solid #1a73e8;
  margin-bottom: 30px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.experiment-goal h4 {
  color: #1a73e8;
  margin-bottom: 15px;
}

.experiment-goal p {
  margin: 0;
  line-height: 1.6;
  font-weight: 500;
}

.dna-zones-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  margin-bottom: 30px;
}

.dna-zone {
  background: white;
  padding: 25px;
  border-radius: 12px;
  border: 3px dashed #ccc;
  min-height: 150px;
  text-align: center;
  transition: all 0.3s ease;
  position: relative;
}

.dna-zone.drag-over {
  border-color: #1a73e8;
  background: #f0f7ff;
  transform: scale(1.02);
}

.dna-zone.drag-over-wrong {
  border-color: #dc3545;
  background: #ffe6e6;
  animation: shake 0.5s ease-in-out;
}

.dna-zone h4 {
  color: #333;
  margin-bottom: 10px;
  font-size: 1.2rem;
}

.zone-hint {
  color: #666;
  font-size: 0.9rem;
  margin-bottom: 15px;
  font-style: italic;
}

.dropped-tags {
  min-height: 60px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.tag-pool-section h4 {
  color: #1a73e8;
  margin-bottom: 20px;
  text-align: center;
}

.tag-pool {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
  justify-items: center;
}

.trait-tag {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 15px 20px;
  border-radius: 25px;
  cursor: grab;
  transition: all 0.3s ease;
  font-weight: 600;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
  border: 2px solid transparent;
  user-select: none;
}

.trait-tag:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

.trait-tag:active {
  cursor: grabbing;
  transform: scale(0.95);
}

.trait-tag.dragging {
  opacity: 0.7;
  transform: rotate(5deg);
}

.trait-tag.dropped {
  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
  box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
  position: relative;
}

.trait-tag.dropped::before {
  content: "âœ…";
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
}

.synthesis-section {
  margin-top: 30px;
}

.synthesis-btn {
  background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
  color: white;
  border: none;
  padding: 15px 30px;
  border-radius: 25px;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.synthesis-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
}

.synthesis-btn:active {
  transform: scale(0.95);
}

.synthesis-result {
  background: white;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.08);
}

.synthesis-result h4 {
  color: #28a745;
  margin-bottom: 20px;
}

.spy-result {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 30px;
  flex-wrap: wrap;
}

.spy-logo {
  background: linear-gradient(135deg, #1a73e8 0%, #0d47a1 100%);
  color: white;
  padding: 20px 30px;
  border-radius: 12px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(26, 115, 232, 0.3);
}

.spy-text {
  display: block;
  font-size: 2rem;
  font-weight: bold;
  letter-spacing: 2px;
}

.spy-subtitle {
  display: block;
  font-size: 0.8rem;
  margin-top: 5px;
  opacity: 0.9;
}

.spy-family-meme {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.anya-face {
  font-size: 2rem;
  animation: bounce 2s infinite;
}

.waku-text {
  background: linear-gradient(45deg, #ff6b9d, #c44569);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-weight: bold;
  font-size: 1.1rem;
}

.gene-popup {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2000;
}

/* å‹•ç•«æ•ˆæœ */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
  40% { transform: translateY(-10px); }
  60% { transform: translateY(-5px); }
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  .gene-lab-section {
    padding: 20px 15px;
  }
  
  .dna-zones-container {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .tag-pool {
    grid-template-columns: 1fr;
  }
  
  .spy-result {
    flex-direction: column;
    gap: 15px;
  }
  
  .experiment-goal {
    padding: 20px;
  }
}

/* ...existing code... */
</style>

<script>
function showFeatureDetail(card, feature) {
  card.querySelector('.feature-detail').style.opacity = '1';
  card.querySelector('.feature-detail').style.transform = 'scale(1)';
}

function hideFeatureDetail(card) {
  card.querySelector('.feature-detail').style.opacity = '0';
  card.querySelector('.feature-detail').style.transform = 'scale(0.9)';
}

function toggleAIChat() {
  const chat = document.getElementById('aiChat');
  chat.style.display = chat.style.display === 'none' || !chat.style.display ? 'flex' : 'none';
}

function askPresetQuestion(question) {
  addMessage(question, 'user');
  
  const answers = {
    'ä»€éº¼æ˜¯ ETFï¼Ÿç‚ºä»€éº¼è¦æŠ•è³‡ ETFï¼Ÿ': `ETFï¼ˆäº¤æ˜“æ‰€äº¤æ˜“åŸºé‡‘ï¼‰æ˜¯ä¸€ç¨®åœ¨è­‰åˆ¸äº¤æ˜“æ‰€ä¸Šå¸‚çš„åŸºé‡‘ï¼Œå®ƒçµåˆäº†è‚¡ç¥¨çš„äº¤æ˜“ä¾¿åˆ©æ€§å’ŒåŸºé‡‘çš„åˆ†æ•£æŠ•è³‡å„ªå‹¢ã€‚

æŠ•è³‡ ETF çš„ä¸»è¦å„ªé»ï¼š

â€¢ åˆ†æ•£é¢¨éšª
  - ä¸€æ¬¡æŠ•è³‡å¤šå®¶å…¬å¸
  - é™ä½å–®ä¸€è‚¡ç¥¨é¢¨éšª

â€¢ äº¤æ˜“æ–¹ä¾¿
  - åƒè‚¡ç¥¨ä¸€æ¨£å³æ™‚è²·è³£
  - äº¤æ˜“é–€æª»ä½

â€¢ æˆæœ¬ä½
  - ç®¡ç†è²»ç”¨è¼ƒä½
  - æ‰‹çºŒè²»è¼ƒä¾¿å®œ

â€¢ é€æ˜åº¦é«˜
  - æŠ•è³‡æ¨™çš„æ¸…æ¥š
  - åƒ¹æ ¼å³æ™‚æ›´æ–°

ç‰¹åˆ¥é©åˆæ–°æ‰‹æŠ•è³‡äººï¼Œå› ç‚ºä¸éœ€è¦é¸è‚¡ï¼Œå°±èƒ½åƒèˆ‡æ•´é«”å¸‚å ´è¡¨ç¾ã€‚`,
    
    'ETF å’Œè‚¡ç¥¨åŸºé‡‘æœ‰ä»€éº¼ä¸åŒï¼Ÿ': `ETF å’Œè‚¡ç¥¨åŸºé‡‘é›–ç„¶éƒ½æ˜¯åŸºé‡‘ï¼Œä½†æœ‰ä»¥ä¸‹ä¸»è¦å·®ç•°ï¼š

â€¢ äº¤æ˜“æ–¹å¼
  - ETFï¼šåƒè‚¡ç¥¨ä¸€æ¨£å¯ä»¥å³æ™‚åœ¨äº¤æ˜“æ‰€è²·è³£
  - åŸºé‡‘ï¼šè¦ç­‰åˆ°æ”¶ç›¤å¾Œæ‰èƒ½ç”³è³¼æˆ–è´–å›

â€¢ åƒ¹æ ¼é€æ˜åº¦
  - ETFï¼šåƒ¹æ ¼å³æ™‚æ›´æ–°ï¼Œäº¤æ˜“æ›´éˆæ´»
  - åŸºé‡‘ï¼šè¦ç­‰åˆ°éš”å¤©æ‰çŸ¥é“æ·¨å€¼

â€¢ æŠ•è³‡æˆæœ¬
  - ETFï¼šé€šå¸¸ç®¡ç†è²»è¼ƒä½ï¼ˆç´„ 0.3~1%ï¼‰
  - åŸºé‡‘ï¼šç®¡ç†è²»è¼ƒé«˜ï¼ˆç´„ 1.5~2%ï¼‰

â€¢ æŠ•è³‡é–€æª»
  - ETFï¼šä»¥è‚¡ç‚ºå–®ä½ï¼Œå…¥å ´é–€æª»è¼ƒä½
  - åŸºé‡‘ï¼šå¸¸æœ‰æœ€ä½ç”³è³¼é‡‘é¡é™åˆ¶`,
    
    'å¦‚ä½•é¸æ“‡é©åˆè‡ªå·±çš„ ETFï¼Ÿ': 'é¸æ“‡é©åˆçš„ ETFï¼Œå»ºè­°ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿï¼š\n\n1. ç¢ºå®šæŠ•è³‡ç›®æ¨™\n- è¿½æ±‚ç©©å®šæ”¶ç›Šï¼šé¸æ“‡é«˜è‚¡æ¯ ETF\n- è¿½æ±‚è³‡æœ¬å¢å€¼ï¼šé¸æ“‡æˆé•·æ€§ ETF\n- é¢¨éšªåˆ†æ•£ï¼šé¸æ“‡è¿½è¹¤å¤§ç›¤çš„ ETF\n\n2. è©•ä¼°é‡è¦æŒ‡æ¨™\n- è¦æ¨¡ï¼šè¦æ¨¡è¶Šå¤§è¶Šç©©å®šï¼Œå»ºè­°é¸æ“‡è³‡ç”¢è¦æ¨¡ 10 å„„ä»¥ä¸Š\n- æµå‹•æ€§ï¼šæ—¥å‡æˆäº¤é‡è¶Šå¤§è¶Šå¥½\n- è²»ç”¨ç‡ï¼šè¶Šä½è¶Šå¥½ï¼Œå»ºè­°é¸æ“‡ 0.5% ä»¥ä¸‹\n- è¿½è¹¤èª¤å·®ï¼šè¶Šå°è¶Šå¥½\n\n3. æ–°æ‰‹å»ºè­°\n- å¯ä»¥å¾ 0050ï¼ˆå°ç£ 50ï¼‰é–‹å§‹\n- é…åˆå®šæœŸå®šé¡é™ä½é¢¨éšª\n- è§€å¯Ÿ 3-6 å€‹æœˆå†åŠ ç¢¼',
    
    'ETF æŠ•è³‡æœ‰å“ªäº›é¢¨éšªï¼Ÿ': 'ETF æŠ•è³‡é›–ç„¶ç›¸å°å®‰å…¨ï¼Œä½†ä»å­˜åœ¨ä»¥ä¸‹é¢¨éšªï¼š\n\n1. å¸‚å ´é¢¨éšª\n- è·Ÿéš¨å¤§ç›¤èµ·è½\n- ç¶“æ¿Ÿè¡°é€€æ™‚å¯èƒ½é¢è‡¨è™§æ\n\n2. è¿½è¹¤èª¤å·®é¢¨éšª\n- å¯èƒ½èˆ‡æŒ‡æ•¸è¡¨ç¾æœ‰è½å·®\n- éœ€è¦å®šæœŸæª¢è¦–è¿½è¹¤æ•ˆæœ\n\n3. æµå‹•æ€§é¢¨éšª\n- éƒ¨åˆ† ETF æˆäº¤é‡è¼ƒå°\n- å¯èƒ½å½±éŸ¿è²·è³£åƒ¹æ ¼\n\n4. åŒ¯ç‡é¢¨éšªï¼ˆæµ·å¤– ETFï¼‰\n- åŒ¯ç‡æ³¢å‹•å¯èƒ½å½±éŸ¿å ±é…¬\n- å»ºè­°è€ƒæ…®é¿éšªç´šåˆ¥ ETF\n\né¢¨éšªæ§åˆ¶å»ºè­°ï¼š\n- åˆ†æ•£æŠ•è³‡ä¸åŒé¡å‹ ETF\n- æ¡ç”¨å®šæœŸå®šé¡ç­–ç•¥\n- è¨­å®šåœæé»\n- å®šæœŸæª¢è¦–æŠ•è³‡çµ„åˆ',
    
    '0050 å’Œ 0056 æœ‰ä»€éº¼å·®åˆ¥ï¼Ÿ': '0050 å’Œ 0056 æ˜¯å°ç£æœ€å—æ­¡è¿çš„å…©æª” ETFï¼Œå„æœ‰ç‰¹è‰²ï¼š\n\n1. 0050ï¼ˆå…ƒå¤§å°ç£ 50ï¼‰\n- è¿½è¹¤ï¼šå°ç£ 50 æŒ‡æ•¸\n- æˆåˆ†ï¼šå°è‚¡å¸‚å€¼å‰ 50 å¤§ä¼æ¥­\n- ç‰¹è‰²ï¼šåæ˜ å°è‚¡æ•´é«”è¡¨ç¾\n- é©åˆï¼šæƒ³åƒèˆ‡å°è‚¡æ•´é«”æˆé•·çš„æŠ•è³‡äºº\n\n2. 0056ï¼ˆå…ƒå¤§é«˜è‚¡æ¯ï¼‰\n- è¿½è¹¤ï¼šå°ç£é«˜è‚¡æ¯æŒ‡æ•¸\n- æˆåˆ†ï¼šæ®–åˆ©ç‡é«˜çš„å„ªè³ªä¼æ¥­\n- ç‰¹è‰²ï¼šæ¯å­£é…ç™¼è‚¡åˆ©\n- é©åˆï¼šæƒ³è¦ç©©å®šç¾é‡‘æµçš„æŠ•è³‡äºº\n\né¸æ“‡å»ºè­°ï¼š\n- æ–°æ‰‹å»ºè­°å…ˆå¾ 0050 é–‹å§‹\n- æƒ³è¦å®šæœŸæ”¶å…¥å¯ä»¥é¸ 0056\n- å…©è€…å¯ä»¥äº’è£œï¼Œéƒ½ç´å…¥æŠ•è³‡çµ„åˆ'
  };

  const answer = answers[question] || 'æŠ±æ­‰ï¼Œæˆ‘ç¾åœ¨ç„¡æ³•å›ç­”é€™å€‹å•é¡Œã€‚';
  addMessage(answer, 'ai');
}

function addMessage(text, type) {
  const messages = document.getElementById('aiMessages');
  const messageDiv = document.createElement('div');
  messageDiv.className = 'ai-message';
  
  if (type === 'ai') {
    messageDiv.innerHTML = `
      <span class="ai-icon">ğŸ¤–</span>
      <div class="message-content"></div>
    `;
    messages.appendChild(messageDiv);
    
    const contentDiv = messageDiv.querySelector('.message-content');
    let lines = text.split('\n');
    let currentIndex = 0;

    function showNextLine() {
      if (currentIndex < lines.length) {
        const line = lines[currentIndex].trim();
        if (line) {
          const p = document.createElement('div');
          p.className = 'typing-animation';
          p.textContent = line;
          contentDiv.appendChild(p);
        }
        const delay = line ? 150 : 50;
        setTimeout(() => {
          currentIndex++;
          showNextLine();
        }, delay);
      }
    }

    showNextLine();
  } else {
    messageDiv.innerHTML = `
      <div class="message-content" style="margin-left: auto; background: #e3f2fd;">${text}</div>
    `;
    messages.appendChild(messageDiv);
  }
  
  messages.scrollTop = messages.scrollHeight;
}

// è§£å‰– ETF åŠŸèƒ½
let stockChart = null;
let bondChart = null;

// é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–åœ–è¡¨
document.addEventListener('DOMContentLoaded', function() {
  // åˆå§‹åŒ–è‚¡ç¥¨ ETF åœ“é¤…åœ–
  initStockChart();
  
  // åˆå§‹åŒ–å‚µåˆ¸ ETF åœ“é¤…åœ–
  initBondChart();
});

function initStockChart() {
  const ctx = document.getElementById('stockChart').getContext('2d');
  stockChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['å°ç©é›»', 'é´»æµ·', 'è¯ç™¼ç§‘', 'å…¶ä»–'],
      datasets: [{
        data: [48, 8, 5, 39],
        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#CCCCCC'],
        borderWidth: 2,
        borderColor: '#fff'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: true,
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            padding: 20,
            font: {
              size: 12
            }
          }
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return context.label + ': ' + context.parsed + '%';
            }
          }
        }
      }
    }
  });
}

function initBondChart() {
  const ctx = document.getElementById('bondChart').getContext('2d');
  bondChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['15-20 å¹´åˆ°æœŸçš„å€Ÿæ“š', '20-25 å¹´åˆ°æœŸçš„å€Ÿæ“š', '25+ å¹´åˆ°æœŸçš„å€Ÿæ“š'],
      datasets: [{
        data: [40, 50, 10],
        backgroundColor: ['#4BC0C0', '#9966FF', '#FF9F40'],
        borderWidth: 2,
        borderColor: '#fff'
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: true,
      plugins: {
        legend: {
          position: 'bottom',
          labels: {
            padding: 20,
            font: {
              size: 12
            }
          }
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return context.label + ': ' + context.parsed + '%';
            }
          }
        }
      }
    }
  });
}

function openETF(type) {
  const stockContainer = document.getElementById('stock-chart-container');
  const bondContainer = document.getElementById('bond-chart-container');
  const stockButton = document.getElementById('btn-stock-etf');
  const bondButton = document.getElementById('btn-bond-etf');
  
  // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active ç‹€æ…‹
  stockButton.classList.remove('active');
  bondButton.classList.remove('active');
  
  // éš±è—æ‰€æœ‰å®¹å™¨
  stockContainer.classList.remove('show');
  bondContainer.classList.remove('show');
  stockContainer.style.display = 'none';
  bondContainer.style.display = 'none';
  
  if (type === 'stock') {
    // é¡¯ç¤ºè‚¡ç¥¨ ETF åœ–è¡¨
    stockButton.classList.add('active');
    setTimeout(() => {
      stockContainer.style.display = 'block';
      setTimeout(() => {
        stockContainer.classList.add('show');
        // é‡æ–°æ¸²æŸ“åœ–è¡¨ä»¥ç¢ºä¿æ­£ç¢ºé¡¯ç¤º
        if (stockChart) {
          stockChart.resize();
        }
      }, 50);
    }, 200);
  } else if (type === 'bond') {
    // é¡¯ç¤ºå‚µåˆ¸ ETF åœ–è¡¨
    bondButton.classList.add('active');
    setTimeout(() => {
      bondContainer.style.display = 'block';
      setTimeout(() => {
        bondContainer.classList.add('show');
        // é‡æ–°æ¸²æŸ“åœ–è¡¨ä»¥ç¢ºä¿æ­£ç¢ºé¡¯ç¤º
        if (bondChart) {
          bondChart.resize();
        }
      }, 50);
    }, 200);
  }
}

// æŠ•è³‡éŠæˆ²åŠŸèƒ½
let gameResults = {
  tech: [
    { result: 'âœ… å¤©å•Šï¼ç±³å…¶æ—ä¸‰æ˜Ÿç­‰ç´šçš„ç¾å‘³ï¼', performance: '+50%', type: 'positive' },
    { result: 'âŒ ä¸å¹¸è¸©é›·ï¼é£Ÿç‰©ä¸­æ¯’äº†...', performance: '-40%', type: 'negative' },
    { result: 'ğŸ˜‘ å£å‘³æ™®é€šï¼Œåƒå®Œå°±å¿˜äº†ã€‚', performance: '+5%', type: 'neutral' }
  ],
  traditional: [
    { result: 'âœ… ç¶“å…¸å®¶å¸¸å‘³ï¼æº«æš–åˆæ»¿è¶³ï¼', performance: '+35%', type: 'positive' },
    { result: 'âŒ è‚‰è³ªå¤ªè€ï¼Œå’¬ä¸å‹•...', performance: '-25%', type: 'negative' },
    { result: 'ğŸ˜‘ å°±æ˜¯æ™®é€šçš„é›è…¿ã€‚', performance: '+3%', type: 'neutral' }
  ],
  shipping: [
    { result: 'âœ… æ–°é®®è‚¥ç¾ï¼æµ·å‘³åè¶³ï¼', performance: '+60%', type: 'positive' },
    { result: 'âŒ ä¸æ–°é®®ï¼å®Œå…¨æ²’æœ‰æµ·å‘³...', performance: '-50%', type: 'negative' },
    { result: 'ğŸ˜‘ é‚„å¯ä»¥ï¼Œä½†æ²’ä»€éº¼ç‰¹åˆ¥ã€‚', performance: '+2%', type: 'neutral' }
  ]
};

function selectStock(stockType) {
  // ç¦ç”¨æ‰€æœ‰è‚¡ç¥¨æŒ‰éˆ•
  document.querySelectorAll('.stock-btn').forEach(btn => {
    btn.disabled = true;
  });
  
  // éš¨æ©Ÿé¸æ“‡çµæœ
  const results = gameResults[stockType];
  const randomResult = results[Math.floor(Math.random() * results.length)];
  
  // é¡¯ç¤ºçµæœ
  const resultBox = document.getElementById('single-result');
  resultBox.innerHTML = `
    <div class="result-content">
      <div style="font-size: 1.1rem; margin-bottom: 10px;">${randomResult.result}</div>
      <div style="font-weight: bold; font-size: 1.2rem;">è³‡ç”¢è©•åƒ¹ï¼š${randomResult.performance}</div>
    </div>
  `;
  
  resultBox.className = `result-box show result-${randomResult.type}`;
  resultBox.style.display = 'block';
  
  // å»¶é²é¡¯ç¤ºå½ˆçª—
  setTimeout(() => {
    showGamePopup();
  }, 1500);
}

function selectETF() {
  // ç¦ç”¨ETFæŒ‰éˆ•
  document.getElementById('etf-btn').disabled = true;
  
  // é¡¯ç¤ºETFçµæœ
  const resultBox = document.getElementById('etf-result');
  resultBox.innerHTML = `
    <div class="etf-calculation">
      <div>â€¢ èœè‰²1 (ç‰›æ’)ï¼šã€æœ‰é»è€...ã€ (-10%)</div>
      <div>â€¢ èœè‰²2 (é’èœ)ï¼šã€å¾ˆæ–°é®®ï¼ã€ (+15%)</div>
      <div>â€¢ èœè‰²3 (æ¹¯å“)ï¼šã€é‚„ä¸éŒ¯ã€‚ã€ (+5%)</div>
      <div>â€¢ èœè‰²4 (ç”œé»)ï¼šã€å¤ªç”œäº†ã€‚ã€ (-2%)</div>
    </div>
    <div class="etf-total">
      ã€è‡ªåŠ©é¤ç¸½è©•åƒ¹ã€‘ï¼šæ•´é«”é‚„ç®—æ»¿æ„ï¼<br>
      è³‡ç”¢è©•åƒ¹ï¼š+8%
    </div>
  `;
  
  resultBox.className = 'result-box show result-positive';
  resultBox.style.display = 'block';
  
  // å»¶é²é¡¯ç¤ºå½ˆçª—
  setTimeout(() => {
    showGamePopup();
  }, 2000);
}

function showGamePopup() {
  document.getElementById('gamePopup').style.display = 'flex';
}

function closeGamePopup() {
  document.getElementById('gamePopup').style.display = 'none';
}

// å­¸ç¿’ç­–ç•¥éŠæˆ²åŠŸèƒ½
let studyResults = {
  'all-in': [
    {
      type: 'success',
      title: 'ğŸ“ˆ å¤©å•Šï¼ä½ è³­å°äº†ï¼é€™æ¬¡æ•¸å­¸è¶…ç°¡å–®ï¼',
      scores: [
        { subject: 'æ•¸å­¸ (æº–å‚™100é»)', score: 100, level: 'high', note: 'å–®ç§‘æ¦œé¦–ï¼' },
        { subject: 'è‹±æ–‡ (æº–å‚™0é»)', score: 0, level: 'low' },
        { subject: 'ç‰©ç† (æº–å‚™0é»)', score: 0, level: 'low' },
        { subject: 'ç¤¾æœƒ (æº–å‚™0é»)', score: 0, level: 'low' },
        { subject: 'åœ‹æ–‡ (æº–å‚™0é»)', score: 0, level: 'low' }
      ],
      conclusion: 'ä½ æˆäº†æ•¸å­¸å‚³å¥‡ï¼Œä½†ä¹Ÿç•¶æ‰äº†å…¶ä»–å››ç§‘ã€‚',
      resultClass: 'failure'
    },
    {
      type: 'failure', 
      title: 'ğŸ“‰ å®Œè›‹ï¼ä½ è³­éŒ¯äº†ï¼é€™æ¬¡æ•¸å­¸è¶…é›£...',
      scores: [
        { subject: 'æ•¸å­¸ (æº–å‚™100é»)', score: 10, level: 'low', note: 'å¤±åˆ©ï¼' },
        { subject: 'è‹±æ–‡ (æº–å‚™0é»)', score: 0, level: 'low' },
        { subject: 'ç‰©ç† (æº–å‚™0é»)', score: 0, level: 'low' },
        { subject: 'ç¤¾æœƒ (æº–å‚™0é»)', score: 0, level: 'low' },
        { subject: 'åœ‹æ–‡ (æº–å‚™0é»)', score: 0, level: 'low' }
      ],
      conclusion: 'ä½ å› ç‚ºæ•¸å­¸å¤±åˆ©è€Œå…¨ç›¤çš†è¼¸...',
      resultClass: 'failure'
    }
  ],
  'balanced': {
    type: 'balanced',
    title: 'ğŸ“Š é›–ç„¶ç§‘ç›®æœ‰é›£æœ‰æ˜“ï¼Œä½†ä½ éƒ½ç©©ç©©æ‹¿ä¸‹äº†ï¼',
    scores: [
      { subject: 'æ•¸å­¸ (å¾ˆé›£)', score: 60, level: 'medium' },
      { subject: 'è‹±æ–‡ (ç°¡å–®)', score:  85, level: 'high' },
      { subject: 'ç‰©ç† (æ™®é€š)', score: 70, level: 'medium' },
      { subject: 'ç¤¾æœƒ (æ™®é€š)', score: 75, level: 'medium' },
      { subject: 'åœ‹æ–‡ (ç°¡å–®)', score: 90, level: 'high' }
    ],
    conclusion: 'ç¸½å¹³å‡ï¼š76 åˆ† (æ­å–œï¼Œç©©å¥ All Passï¼)',
    resultClass: 'success'
  }
};

function selectStudyStrategy(strategy) {
  // ç¦ç”¨æ‰€æœ‰ç­–ç•¥æŒ‰éˆ•
  document.getElementById('all-in-btn').disabled = true;
  document.getElementById('balanced-btn').disabled = true;
  
  let result;
  
  if (strategy === 'all-in') {
    // éš¨æ©Ÿé¸æ“‡ all-in çš„çµæœ
    result = studyResults['all-in'][Math.floor(Math.random() * studyResults['all-in'].length)];
  } else {
    result = studyResults['balanced'];
  }
  
  // é¡¯ç¤ºçµæœ
  displayStudyResult(result);
  
  // é¡¯ç¤ºçµæœå€åŸŸ
  document.getElementById('studyResult').style.display = 'block';
  
  // å»¶é²é¡¯ç¤ºå½ˆçª—
  setTimeout(() => {
    showStudyPopup();
  }, 2000);
}

function displayStudyResult(result) {
  const contentDiv = document.getElementById('studyResultContent');
  
  let scoresHTML = '';
  result.scores.forEach(score => {
    const noteText = score.note ? ` (${score.note})` : '';
    scoresHTML += `
      <div class="score-item">
        <span class="score-subject">${score.subject}</span>
        <span class="score-value score-${score.level}">${score.score} åˆ†${noteText}</span>
      </div>
    `;
  });
  
  contentDiv.innerHTML = `
    <div class="result-header">
      <h5 style="color: #1a73e8; margin-bottom: 20px;">${result.title}</h5>
    </div>
    <div class="score-card">
      <h6 style="margin-bottom: 15px; color: #333;"><strong>æˆç¸¾å–®ï¼š</strong></h6>
      ${scoresHTML}
    </div>
    <div class="final-result ${result.resultClass}">
      <strong>çµæœï¼š${result.conclusion}</strong>
    </div>
  `;
}

function showStudyPopup() {
  document.getElementById('studyPopup').style.display = 'flex';
}

function closeStudyPopup() {
  document.getElementById('studyPopup').style.display = 'none';
}

// åŸºå› å¯¦é©—å®¤åŠŸèƒ½
let draggedElement = null;
let correctPlacements = 0;

function dragStart(event) {
  draggedElement = event.target;
  event.target.classList.add('dragging');
}

function allowDrop(event) {
  event.preventDefault();
}

function dropTag(event) {
  event.preventDefault();
  
  if (!draggedElement) return;
  
  const dropZone = event.currentTarget;
  const tagCorrectZone = draggedElement.getAttribute('data-correct');
  const isCorrect = (dropZone.id === 'stockDnaZone' && tagCorrectZone === 'stock') ||
                   (dropZone.id === 'fundDnaZone' && tagCorrectZone === 'fund');
  
  // ç§»é™¤æ‹–æ›³æ•ˆæœ
  draggedElement.classList.remove('dragging');
  dropZone.classList.remove('drag-over', 'drag-over-wrong');
  
  if (isCorrect) {
    // æ­£ç¢ºæ”¾ç½®
    const droppedTagsContainer = dropZone.querySelector('.dropped-tags');
    const clonedTag = draggedElement.cloneNode(true);
    
    // ç§»é™¤åŸæ¨™ç±¤
    draggedElement.remove();
    
    // æ·»åŠ åˆ°æ­£ç¢ºå€åŸŸ
    clonedTag.classList.add('dropped');
    clonedTag.draggable = false;
    clonedTag.removeAttribute('ondragstart');
    droppedTagsContainer.appendChild(clonedTag);
    
    correctPlacements++;
    
    // æª¢æŸ¥æ˜¯å¦å®Œæˆ
    if (correctPlacements === 4) {
      document.getElementById('synthesisSection').style.display = 'block';
    }
    
  } else {
    // éŒ¯èª¤æ”¾ç½® - æ¨™ç±¤å½ˆå›
    dropZone.classList.add('drag-over-wrong');
    setTimeout(() => {
      dropZone.classList.remove('drag-over-wrong');
    }, 500);
  }
  
  draggedElement = null;
}

// æ‹–æ›³æ‡¸åœæ•ˆæœ
document.addEventListener('dragenter', function(event) {
  if (event.target.classList.contains('dna-zone')) {
    event.target.classList.add('drag-over');
  }
});

document.addEventListener('dragleave', function(event) {
  if (event.target.classList.contains('dna-zone')) {
    event.target.classList.remove('drag-over');
  }
});

function synthesizeETF() {
  document.getElementById('synthesisResult').style.display = 'block';
  document.getElementById('synthesisBtn').disabled = true;
  
  // å»¶é²é¡¯ç¤ºå½ˆçª—
  setTimeout(() => {
    showGenePopup();
  }, 1500);
}

function showGenePopup() {
  document.getElementById('genePopup').style.display = 'flex';
}

function closeGenePopup() {
  document.getElementById('genePopup').style.display = 'none';
}
</script>
{% endblock %}